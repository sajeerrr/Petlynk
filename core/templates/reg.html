{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/reg.css' %}">
{% endblock %}

{% block navbar %}{% endblock %}
{% block footer %}{% endblock %}

{% block layout %}

<!-- 
    The 'sign-up-mode' class is toggled by JS.
    If mode == 'register' from Django context, we add it initially.
-->
<div class="auth-container {% if mode == 'register' %}sign-up-mode{% endif %}">

    <!-- Logo Top Left -->
    <a class="auth-brand top-left-brand" href="/">
        <i class="fa-solid fa-paw"></i> PetLynk
    </a>
    <!-- Logo Top Right (for Sign Up mode) -->
    <a class="auth-brand top-right-brand" href="/">
        <i class="fa-solid fa-paw"></i> PetLynk
    </a>

    <div class="forms-container">
        <div class="signin-signup">

            <!-- Login Form -->
            <form action="{% url 'user_login' %}" method="POST" class="sign-in-form" novalidate>
                {% csrf_token %}
                <h2 class="title">Sign in</h2>

                {% if error %}
                <div class="alert alert-danger p-2 mb-3" style="width: 100%; font-size: 0.9rem;">
                    {{ error }}
                </div>
                {% endif %}

                <div class="input-field">
                    <i class="fas fa-user"></i>
                    <input type="text" name="username" placeholder="Username" required />
                </div>
                <div class="input-field">
                    <i class="fas fa-lock"></i>
                    <input type="password" name="password" placeholder="Password" required />
                </div>
                <a href="{% url 'forgot_password' %}" class="forgot-pass">Forgot password?</a>
                <button type="submit" class="btn btn-primary-custom" style="width: 150px; margin-top: 10px;">
                    Login
                </button>
            </form>

            <!-- Register Form -->
            <form action="{% url 'register' %}" method="POST" class="sign-up-form" novalidate>
                {% csrf_token %}
                <h2 class="title">Sign up</h2>

                <!-- We can render the form fields manually or loop them -->
                <!-- Assuming standard RegisterForm with username, email, password -->

                {% for field in form %}
                <div class="input-field">
                    <i class="fas fa-pen"></i> <!-- Generic icon, can be customized based on field name -->
                    {{ field }}
                </div>
                {% if field.errors %}
                <small class="text-danger">
                    {{ field.errors.0 }}
                </small>
                {% endif %}
                {% endfor %}

                <button type="submit" class="btn btn-primary-custom" style="width: 150px; margin-top: 20px;">
                    Sign Up
                </button>
            </form>
        </div>
    </div>

    <!-- Panels (Overlay) -->
    <div class="panels-container">

        <!-- Left Panel (Visible during Login) -->
        <div class="panel left-panel">
            <div class="content">
                <h3>New here?</h3>
                <p>Join the community of animals</p>
                <button class="btn transparent" id="sign-up-btn">
                    Sign up
                </button>
            </div>
        </div>

        <!-- Right Panel (Visible during Register) -->
        <div class="panel right-panel">
            <div class="content">
                <h3>One of us?</h3>
                <p>Already have an account? Sign in and match!</p>
                <button class="btn transparent" id="sign-in-btn">
                    Sign in
                </button>
            </div>
        </div>

    </div>
</div>

<script src="{% static 'js/reg.js' %}"></script>

<style>
    /* Quick fixes for Django form rendering inside custom input-field */
    .sign-up-form .input-field input {
        background: transparent !important;
        border: none !important;
        padding: 0 10px;
        height: 100%;
        width: 100%;
    }

    .sign-up-form .input-field select {
        /* If there are selects */
        background: transparent;
        border: none;
    }
</style>

{% endblock %}